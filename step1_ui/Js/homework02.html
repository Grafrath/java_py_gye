<!DOCTYPE html>
<html lang="ko">
    
    <head>
        <meta charset="UTF-8">
        <title>GitHub ì‚¬ìš©ì ê²€ìƒ‰ê¸° (Fetch ë³µìŠµ)</title>
        <style>
            body {
                font-family: 'Pretendard', sans-serif;
                background: #f7f9fc;
                display: flex;
                flex-direction: column;
                align-items: center;
                margin-top: 50px;
            }
            
            input, button {
                padding: 10px;
                font-size: 16px;
                margin: 5px;
            }
        
            .card {
                margin-top: 20px;
                padding: 20px;
                border-radius: 12px;
                background: white;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                text-align: center;
                width: 280px;
            }
        
            img {
                width: 120px;
                border-radius: 50%;
            }
        
            .error {
                color: red;
                margin-top: 15px;
            }

            .search-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 10px;
                margin-bottom: 20px;
            }

            ul {
                list-style: none;
                padding: 0;
            }

            li {
                margin: 8px 0;
                font-size: 15px;
            }

            .repo-link {
                text-decoration: none;
                color: #0070f3;
                font-weight: 500;
            }

            .repo-link:hover {
                text-decoration: underline;
            }
        </style>
    </head>
    
    <body>
        <!-- ì‚¬ìš©ì ì…ë ¥ ì˜ì—­ -->
        <h1>GitHub ì‚¬ìš©ì ê²€ìƒ‰ê¸°</h1>
        <div class="search-container">
            <!-- ì•„ì´ë”” ì…ë ¥ -->
            <input type="text" id="username" placeholder="GitHub ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            <!-- ë²„íŠ¼ í´ë¦­ ì‹œ ê²€ìƒ‰ -->
            <button id="search">ê²€ìƒ‰</button>
        </div>
        
        <!-- ê²°ê³¼ê°€ í‘œì‹œë  ì˜ì—­ -->
        <div id="result"></div>
        <script>
            /*
            í•™ìŠµ ëª©í‘œ
            - fetch()ë¥¼ ì´ìš©í•œ ë¹„ë™ê¸° í†µì‹  ì´í•´
            - JSON ë°ì´í„°ë¥¼ DOM ìš”ì†Œë¡œ ê°€ê³µí•´ì„œ í™”ë©´ì— ì¶œë ¥í•˜ê¸°
            - ì˜ˆì™¸ ì²˜ë¦¬(try ~ catch)ë¡œ ì—ëŸ¬ ìƒí™©ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²• ë°°ìš°ê¸°
            */

            const input = document.getElementById('username');
            const button = document.getElementById('search');
            const result = document.getElementById('result');

            // ì—”í„°í‚¤ë¡œë„ ê²€ìƒ‰ ê°€ëŠ¥í•˜ë„ë¡ ì¶”ê°€
            input.addEventListener('keypress', e => { if (event.key === 'Enter') button.click(); });

            // ë²„íŠ¼ í´ë¦­ ì‹œ fetchë¡œ GitHub ì‚¬ìš©ì ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
            button.addEventListener('click', async () => {
                const username  = input.value.trim(); // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
                if (!username) {
                    alert('ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                result.innerHTML = ''; // ì´ì „ ê²€ìƒ‰ ê²°ê³¼ ì´ˆê¸°í™”

                try {
                    // ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                    const response = await fetch(`https://api.github.com/users/${username}`);

                    if (!response.ok) throw new Error('ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    const data = await response.json(); // ì‘ë‹µ ë°ì´í„°ë¥¼ JSON í˜•íƒœë¡œ ë³€í™˜

                    // ì‚¬ìš©ìì˜ ì €ì¥ì†Œ ì •ë³´ 5ê°œ ë¶ˆëŸ¬ì˜¤ê¸°
                    const repoResponse = await fetch(`https://api.github.com/users/${username}/repos?sort=updated&per_page=5`);
                    const repos = await repoResponse.json();

                    // ì €ì¥ì†Œ ëª©ë¡ êµ¬ì„±
                    let repoListHTML = '';
                    if (repos.length > 0) {
                        repoListHTML =
                        `<h3>ğŸ“‚ ìµœê·¼ ì €ì¥ì†Œ (5ê°œ)</h3><ul> ${repos.map(repo => `<li>
                        <a class="repo-link" href="${repo.html_url}" target="_blank">${repo.name}</a>
                        â­ ${repo.stargazers_count}</li>`).join('')} </ul>`;
                    } else {
                        repoListHTML = `<p>ì €ì¥ì†Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
                    }

                    // í™”ë©´ì— ìµœì¢… ê²°ê³¼ ì¶œë ¥
                    result.innerHTML = `
                    <div class="card">
                    <img src="${data.avatar_url}" alt="avatar" />
                    <h2>${data.name || 'ì´ë¦„ ì—†ìŒ'}</h2>
                    <p>íŒ”ë¡œì›Œ: ${data.followers}</p>
                    <p>ì €ì¥ì†Œ: ${data.public_repos}</p>
                    <a href="${data.html_url}" target="_blank">í”„ë¡œí•„ ë³´ê¸°</a>
                    <hr>${repoListHTML}
                    </div>`;
                } catch (error) {
                    // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
                    result.innerHTML = `<p class='error'>âŒ ${error.message}</p>`;
                }      
            });      
        </script>
    </body>
    
</html>
